<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" >
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8"/>
	<title>Simplify Admin</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<meta name="description" content=""/>
	<meta name="author" content=""/>
	<!-- Bootstrap core CSS -->
	<link href="/zhou/css/bootstrap.min.css" th:href="@{/zhou/css/bootstrap.min.css}" rel="stylesheet" />
	<!-- Font Awesome -->
	<link href="/zhou/css/font-awesome.min.css" th:href="@{/zhou/css/font-awesome.min.css}" rel="stylesheet" />
	<!-- ionicons -->
	<link href="/zhou/css/ionicons.min.css" th:href="@{/zhou/css/ionicons.min.css}" rel="stylesheet" />
	<!-- Morris -->
	<link href="/index/css/morris.css" th:href="@{/index/css/morris.css}" rel="stylesheet"/>
	<!-- Datepicker -->
	<link href="/index/css/datepicker.css" th:href="@{/index/css/datepicker.css}" rel="stylesheet"/>
	<!-- Animate -->
	<link href="/index/css/animate.min.css" th:href="@{/index/css/animate.min.css}" rel="stylesheet" />
	<!-- Owl Carousel -->
	<link href="/index/css/owl.carousel.min.css" th:href="@{/index/css/owl.carousel.min.css}" rel="stylesheet" />
	<link href="/index/css/owl.theme.default.min.css" th:href="@{/index/css/owl.theme.default.min.css}" rel="stylesheet" />
	<!-- index -->
	<link href="/index/css/index.min.css" th:href="@{/index/css/index.min.css}" rel="stylesheet" />
	<!-- Jquery -->
	<script src="/zhou/js/jquery.min.js" th:src="@{/zhou/js/jquery.min.js}"></script>
	<!-- Bootstrap -->
	<script src="/zhou/js/bootstrap.min.js" th:src="@{/zhou/js/bootstrap.min.js}"></script>
	<!-- Flot -->
	<script src='/zhou/js/jquery.flot.min.js' th:src="@{/zhou/js/jquery.flot.min.js}"></script>
	<!-- Slimscroll -->
	<script src='/zhou/js/jquery.slimscroll.min.js' th:src="@{/zhou/js/jquery.slimscroll.min.js}"></script>
	<!-- Morris -->
	<script src='/index/js/rapheal.min.js' th:src="@{/index/js/rapheal.min.js}"></script>
	<script src='/index/js/morris.min.js' th:src="@{/index/js/morris.min.js}"></script>
	<!-- Datepicker -->
	<script src='/index/js/datepicker.js' th:src="@{/index/js/datepicker.js}"></script>
	<!-- Sparkline -->
	<script src='/index/js/sparkline.min.js' th:src="@{/index/js/sparkline.min.js}"></script>
	<!-- Skycons -->
	<script src='/index/js/skycons.js' th:src="@{/index/js/skycons.js}"></script>
	<!-- Popup Overlay -->
	<script src='/zhou/js/jquery.popupoverlay.min.js' th:src="@{/zhou/js/jquery.popupoverlay.min.js}"></script>
	<!-- Easy Pie Chart -->
	<script src='/zhou/js/jquery.easypiechart.min.js' th:src="@{/zhou/js/jquery.easypiechart.min.js}"></script>
	<!-- Sortable -->
	<script src='/zhou/js/jquery.sortable.js' th:src="@{/zhou/js/jquery.sortable.js}"></script>
	<!-- Owl Carousel -->
	<script src='/index/js/owl.carousel.min.js' th:src="@{/index/js/owl.carousel.min.js}"></script>
	<!-- Modernizr -->
	<script src='/index/js/modernizr.min.js' th:src="@{/index/js/modernizr.min.js}"></script>
	<!-- index -->
	<script src="/index/js/index.js" th:src="@{/index/js/index.js}"></script>
	<script src="/index/js/index_dashboard.js" th:src="@{/index/js/index_dashboard.js}"></script>
	<!-- layer +layui -->
	<script th:src="@{/zhou/plugins/layer/layer.js}"></script>
	<script th:src="@{/zhou/plugins/layui/layui.all.js}"></script>
	<link th:href="@{/zhou/plugins/layui/css/layui.css}" rel="stylesheet" />

</head>

<body class="overflow-hidden">
<div class="padding-md">
	<ul class="breadcrumb">
		<li><span class="primary-font"><i class="icon-home"></i></span><a href="#"> 主页</a></li>
		<li>博客列表</li>
	</ul>
	<table class="table table-striped" id="dataTable">
		<thead>
		<tr>
			<th>标题</th>
			<th>时间</th>
			<th>作者</th>
			<th>阅读</th>
			<th>评论</th>
			<th>操作</th>
		</tr>
		</thead>
		<tbody id="tbody"></tbody>
	</table>
</div><!-- ./padding-md -->
	<a href="#" class="scroll-to-top hidden-print"><i class="fa fa-chevron-up fa-lg"></i></a>
	<script th:inline="javascript">
	/*<![CDATA[*/
        $(function()	{
            //$('#dataTable').dataTable();
            init();


        });

        function init(){
            $.ajax({
                url: "/blog/getBlogList",
                dataType:"json",
                type:"post",
                data:{},
                success: function (data) {
                    var str = "";
                    for(var i=0;i<data.length;i++){
                        str += "<tr></tr><td><a href='/blog/blog?id="+data[i].id+"' id='"+data[i].id+"'>"+data[i].title+"</a></td>";
                        str += "<td>"+new Date(data[i].createTime).toLocaleString()+"</td>";
                        str += "<td>"+data[i].sysUser.username+"</td>";
                        str += "<td>"+data[i].readCount+"</td>";
                        str += "<td>"+data[i].commentCount+"</td>";
                        str += "<td><a href='/blog/blog?id="+data[i].id+"' style='margin-left:5px;'><span class='label label-success'>查看</span></a>";
                        str += "<a href='#' onclick=\"editBlog('"+data[i].id+"')\" style='margin-left:5px;'><span class='label label-info'>编辑</span></a>";
						str += "<a href='#' onclick=\"deleteBlog('"+data[i].id+"')\" style='margin-left:5px;'><span class='label label-danger'>删除</span></a>";
                        str +="</td></tr>";
                    }
                    $("#tbody").html(str);
                },
                error:function (error) {
                    layer.msg("获取博客列表失败");
                }
            });
		}
		function editBlog(id) {
            window.location.href="/blog/mdeditor?id="+id;
        }
		function deleteBlog(id) {
            $.ajax({
                url: "/blog/deleteBlog",
                dataType:"text",
                type:"post",
                data:{"id":id},
                success: function (data) {
                    if(data=="1"){
                        layer.msg("删除成功");
                        window.location.href="/blog/blogList";
					}else{
                        layer.msg("删除失败");
					}
                }
            });
        }
        /*]]>*/
	</script>

</body>
</html>
